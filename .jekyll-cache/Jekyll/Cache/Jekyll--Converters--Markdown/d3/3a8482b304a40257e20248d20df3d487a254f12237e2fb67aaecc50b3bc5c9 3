I"×0<h1 id="gcc-ì»´íŒŒì¼-ë°©ë²•">gcc ì»´íŒŒì¼ ë°©ë²•</h1>
<ul>
  <li>ì˜µì…˜
    <ul>
      <li>-o: ì˜¤ë¸Œì íŠ¸ì˜ íŒŒì¼ëª… ì„¤ì •</li>
      <li>-c: ì†ŒìŠ¤íŒŒì¼ê³¼ ê°™ì€ ì´ë¦„ì˜ ì˜¤ë¸Œì íŠ¸ íŒŒì¼ ìƒì„±</li>
      <li>-I(ëŒ€ë¬¸ì i): í—¤ë”íŒŒì¼ì„ ê²€ìƒ‰í•  ë””ë ‰í† ë¦¬ ëª…</li>
      <li>-L: ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê²€ìƒ‰í•  ë””ë ‰í† ë¦¬ëª…</li>
      <li>-l(ì†Œë¬¸ì L): ë§í¬í•  ë¼ì´ë¸ŒëŸ¬ë¦¬ íŒŒì¼ëª…</li>
    </ul>
  </li>
  <li>c ì»´íŒŒì¼
    <ul>
      <li>gcc -o <ì¶œë ¥íŒŒì¼ëª…> <c íŒŒì¼ëª…=""></c></ì¶œë ¥íŒŒì¼ëª…></li>
      <li>ex) gcc -o main main.c</li>
    </ul>
  </li>
  <li>ì‹¤í–‰
    <ul>
      <li>./<ìƒì„±ëœ ì‹¤í–‰íŒŒì¼ëª…=""></ìƒì„±ëœ></li>
      <li>ex) ./main</li>
    </ul>
  </li>
</ul>

<h1 id="fork-ì‹œìŠ¤í…œ-ì½œ">fork() ì‹œìŠ¤í…œ ì½œ</h1>
<ul>
  <li>í”„ë¡œì„¸ìŠ¤ ìƒì„±ì— fork() ì‹œìŠ¤í…œ ì½œì´ ì‚¬ìš©ëœë‹¤.</li>
  <li>fork() ëŠ” ìì‹ ê³¼ ë¹„ìŠ·í•œ ìì‹ í”„ë¡œì„¸ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.
    <ul>
      <li>ìì‹ í”„ë¡œì„¸ìŠ¤ëŠ” ìì‹ ì˜ ì£¼ì†Œ ê³µê°„, ìì‹ ì˜ ë ˆì§€ìŠ¤í„°, ìì‹ ì˜ PC ê°’ì„ ê°€ì§„ë‹¤.</li>
    </ul>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-c" data-lang="c">    <span class="cp">#include &lt;stdio.h&gt;
</span>    <span class="cp">#include &lt;stdlib.h&gt;
</span>    <span class="cp">#include &lt;unistd.h&gt;
</span>
    <span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]){</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"hello world (pid:%d)</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">getpid</span><span class="p">());</span>
        <span class="kt">int</span> <span class="n">rc</span> <span class="o">=</span> <span class="n">fork</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">rc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">){</span>
            <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">"fork failed</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">rc</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"hello, I am child (pid:%d)</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">getpid</span><span class="p">());</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"hello, I am parent of %d (pid:%d)</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">rc</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">getpid</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span></code></pre></figure>

<p><img src="../../assets/img/ostep/process_API/img.png" width="80%" height="100%" /></p>

<h1 id="forkì™€-wait-í˜¸ì¶œ">fork()ì™€ wait() í˜¸ì¶œ</h1>
<ul>
  <li>wait() ì‹œìŠ¤í…œ ì½œì„ í˜¸ì¶œí•˜ì—¬ ìì‹ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ ì‹œì ê¹Œì§€ ìì‹ ì˜ ì‹¤í–‰ì„ ì ì‹œ ì¤‘ì§€ì‹œí‚¨ë‹¤.</li>
</ul>

<figure class="highlight"><pre><code class="language-c" data-lang="c">    <span class="cp">#include &lt;stdio.h&gt;
</span>    <span class="cp">#include &lt;unistd.h&gt;
</span>    <span class="cp">#include &lt;stdlib.h&gt;
</span>    
    <span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
        <span class="c1">// insert code here...</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"hello world (pid:%d)'</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">getpid</span><span class="p">());</span>
        <span class="kt">int</span> <span class="n">rc</span> <span class="o">=</span> <span class="n">fork</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">rc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">"fork failen"</span><span class="p">);</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">rc</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"hello, I am child (pid:%d)</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">getpid</span><span class="p">());</span>
        <span class="p">}</span> <span class="k">else</span><span class="p">{</span>
            <span class="kt">int</span> <span class="n">rc_wait</span> <span class="o">=</span> <span class="n">wait</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"hello, I am parent of %d (rc_wait:%d) (pid:%d)</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">rc</span><span class="p">,</span> <span class="n">rc_wait</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">getpid</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span></code></pre></figure>

<p><img src="../../assets/img/ostep/process_API/img_1.png" width="80%" height="100%" /></p>

<ul>
  <li>ê²°ê³¼ë¥¼ ë³´ë©´ ì•Œ ìˆ˜ ìˆë“¯ì´ fork() í•¨ìˆ˜ë§Œ ì‚¬ìš©í–ˆì„ ë•ŒëŠ” ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ì˜ ì •ë³´ê°€ ë¨¼ì € ì¶œë ¥ë˜ì—ˆì§€ë§Œ, wait()ì„ ì‚¬ìš©í•´ì„œ ìì‹ í”„ë¡œì„¸ìŠ¤ì˜ ì •ë³´ê°€ ë¨¼ì € ì¶œë ¥ ë˜ì—ˆë‹¤.</li>
</ul>

<h1 id="exec-ì‹œìŠ¤í…œ-ì½œ">exec() ì‹œìŠ¤í…œ ì½œ</h1>
<ul>
  <li>ìê¸° ìì‹ ì´ ì•„ë‹Œ ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•´ì•¼ í•  ë•Œ ì‚¬ìš©í•œë‹¤.</li>
  <li>fork() ì‹œìŠ¤í…œ ì½œì€ ìì‹ ì˜ ë³µì‚¬ë³¸ì„ ìƒì„±í•˜ì—¬ ì‹¤í–‰í•œë‹¤.</li>
  <li>exec() ì‹œìŠ¤í…œ ì½œì€ ìì‹ ì˜ ë³µì‚¬ë³¸ì´ ì•„ë‹Œ ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ ì‹¤í–‰í•œë‹¤.</li>
</ul>

<figure class="highlight"><pre><code class="language-c" data-lang="c">    <span class="cp">#include &lt;stdio.h&gt;
</span>    <span class="cp">#include &lt;unistd.h&gt;
</span>    <span class="cp">#include &lt;stdlib.h&gt;
</span>    <span class="cp">#include &lt;string.h&gt;
</span>    <span class="cp">#include &lt;sys/wait.h&gt;
</span>    
    <span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"hello world (pid:%d)'</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">getpid</span><span class="p">());</span>
        <span class="kt">int</span> <span class="n">rc</span> <span class="o">=</span> <span class="n">fork</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">rc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">"fork failen"</span><span class="p">);</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">rc</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"hello, I am child (pid:%d)</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">getpid</span><span class="p">());</span>
            <span class="kt">char</span> <span class="o">*</span><span class="n">myargs</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
            <span class="n">myargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">strdup</span><span class="p">(</span><span class="s">"wc"</span><span class="p">);</span>
            <span class="n">myargs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">strdup</span><span class="p">(</span><span class="s">"main.c"</span><span class="p">);</span>
            <span class="n">myargs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
            <span class="n">execvp</span><span class="p">(</span><span class="n">myargs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">myargs</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"this shouldn't print out"</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span><span class="p">{</span>
            <span class="kt">int</span> <span class="n">rc_wait</span> <span class="o">=</span> <span class="n">wait</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"hello, I am parent of %d (rc_wait:%d) (pid:%d)</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">rc</span><span class="p">,</span> <span class="n">rc_wait</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">getpid</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span></code></pre></figure>

<p><img src="../../assets/img/ostep/process_API/img_2.png" width="80%" height="100%" /></p>

<ul>
  <li>ê²°ê³¼ë¥¼ ë³´ë©´ exec() í•¨ìˆ˜ í˜¸ì¶œ ì´í›„ â€œprintf(â€œthis shouldnâ€™t print outâ€);â€ ì´ ì¶œë ¥ë˜ì§€ ì•ŠìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<h1 id="ì™œ-ì´ëŸ°-apië¥¼">ì™œ, ì´ëŸ° APIë¥¼?</h1>
<ul>
  <li>Unix ì‰˜ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œëŠ” fork()ì™€ exec()ì„ ë¶„ë¦¬í•´ì•¼í•œë‹¤.</li>
  <li>ê·¸ë˜ì•¼ë§Œ ì‰˜ì´ fork()ë¥¼ í˜¸ì¶œí•˜ê³  exec()ë¥¼ í˜¸ì¶œí•´ì„œ í”„ë¡œì„¸ìŠ¤ë¥¼ ë§Œë“¤ì–´ë‚¸ë‹¤.</li>
</ul>
:ET