<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>[OSTEP] 메모리 가상화 - 페이징 개선(TLB, 더 작은 테이블) - 홍구의 개발 블로그</title>
<meta name="description" content="OSTEP - 07">


  <meta name="author" content="honggoo">
  
  <meta property="article:author" content="honggoo">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="홍구의 개발 블로그">
<meta property="og:title" content="[OSTEP] 메모리 가상화 - 페이징 개선(TLB, 더 작은 테이블)">
<meta property="og:url" content="http://localhost:4000/ostep/ostep_07/">


  <meta property="og:description" content="OSTEP - 07">



  <meta property="og:image" content="https://images.unsplash.com/photo-1501785888041-af3ef285b470?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80">





  <meta property="article:published_time" content="2022-06-09T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/ostep/ostep_07/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "honggoo",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="홍구의 개발 블로그 Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          홍구의 개발 블로그
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about_me/">About Me</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Category</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tag</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/">Archive</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero--overlay"
  style=" background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://images.unsplash.com/photo-1501785888041-af3ef285b470?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80');"
>
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        
          [OSTEP] 메모리 가상화 - 페이징 개선(TLB, 더 작은 테이블)

        
      </h1>
      
        <p class="page__lead">OSTEP - 07
</p>
      
      

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-06-09T00:00:00+09:00">June 9, 2022</time>
      </span>
    

    

    
  </p>


      
      
    </div>
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/img/avatar2.png" alt="honggoo" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">honggoo</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>본격적인 개발 블로그를 시작해 볼까!</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Seoul, South Korea</span>
        </li>
      

      
        
          
            <li><a href="cocoti5797@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/hon99oo" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://instagram.com/hon99oo" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
  

  

  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="[OSTEP] 메모리 가상화 - 페이징 개선(TLB, 더 작은 테이블)">
    <meta itemprop="description" content="OSTEP - 07">
    <meta itemprop="datePublished" content="2022-06-09T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      

      <section class="page__content e-content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-bars"></i> table of content</h4></header>
              <ul class="toc__menu"><li><a href="#1-페이징-더-빠른-변환tlb">1. 페이징: 더 빠른 변환(TLB)</a><ul><li><a href="#11-tlb의-기본-알고리즘">1.1 TLB의 기본 알고리즘</a></li><li><a href="#12-예제-배열-접근">1.2 예제: 배열 접근</a></li><li><a href="#13-tlb-미스는-누가-처리할까">1.3 TLB 미스는 누가 처리할까</a><ul><li><a href="#cisccomplex-instruction-set-computers-tlb-미스를-하드웨어가-처리하도록-설계">CISC(complex-instruction set computers): TLB 미스를 하드웨어가 처리하도록 설계</a></li><li><a href="#riscreduced-instruction-set-computing-소프트웨어-관리-tlb-사용">RISC(reduced instruction set computing): 소프트웨어 관리 TLB 사용</a></li></ul></li><li><a href="#14-tlb의-구성-무엇이-있나">1.4 TLB의 구성: 무엇이 있나?</a></li><li><a href="#15-tlb의-문제-문맥-교환">1.5 TLB의 문제: 문맥 교환</a></li><li><a href="#16-이슈-교체-정책">1.6 이슈: 교체 정책</a></li><li><a href="#17-요약">1.7 요약</a></li></ul></li><li><a href="#2-페이징-더-작은-테이블">2. 페이징: 더 작은 테이블</a><ul><li><a href="#21-간단한-해법-더-큰-페이지">2.1 간단한 해법: 더 큰 페이지</a></li><li><a href="#22-하이브리드-접근-방법-페이징과-세그멘트">2.2 하이브리드 접근 방법: 페이징과 세그멘트</a></li><li><a href="#23-멀티-레벨-페이지-테이블">2.3 멀티 레벨 페이지 테이블</a></li><li><a href="#24-역-페이지-테이블">2.4 역 페이지 테이블</a></li><li><a href="#25-페이지-테이블을-디스크로-스와핑하기">2.5 페이지 테이블을 디스크로 스와핑하기</a></li><li><a href="#26-요약">2.6 요약</a></li></ul></li></ul>

            </nav>
          </aside>
        
        <h1 id="1-페이징-더-빠른-변환tlb">1. 페이징: 더 빠른 변환(TLB)</h1>
<ul>
  <li>페이징은 주소 공간을 작은 크기(페이지)로 나누고 각 페이지의 실제 위치(매핑 정보)를 메모리에 저장한다. 매핑 정보를 저장하는 자료 구조를 페이지 테이블이라 한다.</li>
  <li>페이징은 성능 저하를 유발할 수 있다.
    <ul>
      <li>가상 주소에서 물리 주소로의 주소 변환을 위해 메모리에 존재하는 매핑 정보를 읽어야 한다는 사실은 페이지 테이블 접근을 위한 메모리 읽기 작업이며 이는 엄청난 성능 저하를 유발한다.</li>
    </ul>
  </li>
</ul>

<p><br /></p>
<ul>
  <li>주소 변환을 빠르게 하기 위해서 우리는 <strong>변환-색인 버퍼(translation-lookaside buffer)</strong> 또는 <strong>TLB</strong>를 도입한다.
    <ul>
      <li>TLB는 칩의 <strong>메모리 관리부(memory-management unit, MMU)</strong>의 일부이다.</li>
      <li>자주 참조되는 VirtualMemory-PhysicalMemory 변환 정보를 저장하는 하드웨어 캐시이다.</li>
      <li>가상 메모리 참조 시, 하드웨어는 먼저 TLB에 원하는 변환 정보가 있는지를 확인한다. 만약 있다면 페이지 테이블을 통하지 않고 변환을 빠르게 수행한다. 실질적으로 TLB는 페이징 성능을 엄청나게 향상시킨다.</li>
    </ul>
  </li>
</ul>

<h2 id="11-tlb의-기본-알고리즘">1.1 TLB의 기본 알고리즘</h2>
<ul>
  <li>주소 변환부는 단순한 <strong>선형 페이지 테이블</strong>(배열로 이루어진 페이지 테이블) 과 <strong>하드웨어로 관리되는 TLB</strong>로 구성되어 있다.</li>
  <li>하드웨어 부분의 알고리즘은 다음과 같이 동작한다. (TLB Hit 과 Miss로 나뉨)</li>
  <li>TLB Hit
    <ol>
      <li>가상주소에서 가상 페이지 번호(virtual page nubmer, <strong>VPN</strong>)을 추출한 후, 해당 VPN을 TLB 존재 여부를 검사한다.</li>
      <li>만약 존재한다면 <strong>TLB 히트</strong>이고 TLB가 변환 값을 갖고 있다는 것을 뜻한다.</li>
      <li>해당 TLB 항목에서 페이지 프레임 번호(page fame number, PFN)을 추출한다.</li>
      <li>해당 페이지에 대한 접근 권한 검사가 성공하면</li>
      <li>그 정보를 원래 가상 주소의 오프셋과 합쳐서 원하는 물리 주소를 구성하고 메모리에 접근한다.</li>
    </ol>
  </li>
  <li>TLB Miss
    <ol>
      <li>위의 2번에서 TLB Miss되면</li>
      <li>하드웨어가 변환 정보를 찾기 위해서 페이지 테이블에 접근한다.</li>
      <li>프로세스가 생성한 가상 메모리 참조가 유효하고 접근 가능하다면</li>
      <li>해당 변환정보를 TLB로 읽어들인다.(시간이 많이 소요되는 작업, 테이블 접근을 위한 메모리 참조 때문)</li>
      <li>TLB가 갱신되면 하드웨어는 명령어를 재실행한다.</li>
    </ol>
  </li>
  <li>TLB는 프로세싱 코어와 가까운 곳에 위치하고 있고, 매우 빠른 하드웨어로 구성되기 때문에, 주소 변환 작업은 그다지 부담스러운 작업이아니다.</li>
  <li>TLB 미스가 많이 발생할수록 메모리 접근 횟수가 많아진다.
    <ul>
      <li>TLB 미스가 발생하는 경우를 최대한 피해야 한다.</li>
    </ul>
  </li>
</ul>

<h2 id="12-예제-배열-접근">1.2 예제: 배열 접근</h2>

<p><img src="../../assets/img/ostep/07/img.png" width="40%" height="100%" /></p>
<ul>
  <li>위의 그림과 같이 배열의 데이터가 저장되어 있다고 가정하자.
    <ul>
      <li>index 0부터 9까지 배열을 읽으면 index0을 읽을 때 TLB는 초기화 되어있기 때문에 TLB미스가 발생하고 VPN 06번 페이지를 TLB를 가져온다.</li>
      <li>이후 1번과 2번 index를 읽을 때는 TLB히트가 발생하여 바로 가져올 수 있다.</li>
      <li>다시 3번 index를 읽을 때는 TLB미스가 발생하여 VPN 07번 페이지를 TLB로 가져온다.</li>
    </ul>
  </li>
  <li>위의 예제를 통해 배열이 처음으로 접근되었지만, TLB는 <strong>공간 지역성</strong>으로 인해서 성능을 개선할 수 있다.</li>
  <li>만약 TLB가 모든 주소 변환 정보를 저장할 정도로 충분히 크다면 히트, 히트, 히트, 히트, … 히트 를 얻는다.
    <ul>
      <li>이 경우에는 <strong>시간 지역성</strong>으로 인해 TLB의 히트율이 높아진다.</li>
    </ul>
  </li>
  <li>프로그램이 공간 혹은 시간 지역성을 보이는 경우, TLB 사용 효과가 더욱 두드러지게 나타날 것이다.</li>
</ul>

<h2 id="13-tlb-미스는-누가-처리할까">1.3 TLB 미스는 누가 처리할까</h2>
<ul>
  <li>TLB 미스의 처리는 두 가지 방법이 있다.
    <ul>
      <li>하드웨어와 소프트웨어이다.</li>
    </ul>
  </li>
</ul>

<h3 id="cisccomplex-instruction-set-computers-tlb-미스를-하드웨어가-처리하도록-설계">CISC(complex-instruction set computers): TLB 미스를 하드웨어가 처리하도록 설계</h3>
<ul>
  <li>이를 위해서 하드웨어가 페이지 테이블에 대한 명확한 정보를 가지고 있어야 한다.
    <ul>
      <li>메모리 상 위치(<strong>page-table base register</strong>를 통해서)와 정확한 형식을 파악하고 있어야 한다.</li>
    </ul>
  </li>
  <li>미스 발생시 다음과 같은 일을 한다.
    <ol>
      <li>페이지 테이블에서 원하는 페이지 테이블 엔트리를 찾고</li>
      <li>필요한 변환 정보를 추출하여</li>
      <li>TLB를 갱신한 후</li>
      <li>TLB 미스가 발생한 명령어를 재실행한다.</li>
    </ol>
  </li>
  <li>x86 CPU가 하드웨어로 관리 되는 TLB의 대표적인 예다.
    <ul>
      <li>멀티 레벨 페이지 테이블을 사용한다.</li>
    </ul>
  </li>
</ul>

<h3 id="riscreduced-instruction-set-computing-소프트웨어-관리-tlb-사용">RISC(reduced instruction set computing): 소프트웨어 관리 TLB 사용</h3>
<ul>
  <li>RISC 기반 컴퓨터에서 TLB 미스를 처리하는 과정은 다음과 같다.
    <ol>
      <li>TLB에서 주소 찾는 것이 실패하면, 하드웨어는 예외 시그널을 발생시킨다.</li>
      <li>예외 시그널을 받은 운영체제는 명령어 실행을 잠정 중지하고, 실행 모드를 커널 모드로 변경하여, 커널 코드 실행을 준비한다.
        <ul>
          <li>실행 모드를 커널 모드로 변경하는 작업의 핵심은 커널 주소 공간을 접근할 수 있또록 특권 레벨(privilege level)로 상향 조정하는 것이다.</li>
        </ul>
      </li>
      <li>커널 모드로 변경이 되면 <strong>트랩 핸들러(trap handler)</strong>를 실행한다.
        <ul>
          <li>이 때 실행되는 트랩 핸들러는 TLB 미스의 처리를 담당하는 운영체제 코드이다.</li>
        </ul>
      </li>
      <li>이 트랩 핸들러는 페이지 테이블을 검색하여 변환 정보를 찾고, TLB 접근이 가능한 “특권” 명령어를 사용하여 TLB를 갱신한 후에 리턴한다.</li>
      <li>트랩 핸들러에서 리턴되면 하드웨어가 명령어를 재실행한다.</li>
    </ol>
  </li>
  <li>TLB 미스를 처리하는 트랩 핸들러는 시스템 콜 호출 시 사용되는 트랩 핸들러와의 차이가 있다.
    <ul>
      <li>TLB 미스 처리의 경우 다음 명령어의 PC값을 트랩을 발생시킨 명령을 다시 실행해야한다.</li>
    </ul>
  </li>
  <li>
    <p>TLB 미스 핸들러를 실행할 때, TLB 미스가 무한 반복되지 않도록 주의해야 한다.</p>
  </li>
  <li>TLB를 소프트웨어로 관리하는 방식의 주된 장점은 유연성과 단순함이다.</li>
</ul>

<h2 id="14-tlb의-구성-무엇이-있나">1.4 TLB의 구성: 무엇이 있나?</h2>
<ul>
  <li>TLB는 32, 64, 또는 128개의 엔트리를 가지며, <strong>완전 연관(fully associative)</strong> 방식으로 설계된다.
    <ul>
      <li>완전 연관 방식에서 변환 정보는 TLB 내에 어디든 위치할 수 있으며, 원하는 변환 정보를 찾는 검색은 TLB 전체에서 병렬적으로 수행된다.</li>
    </ul>
  </li>
  <li>TLB의 구성: VPN \ PFN \ offset(다른 비트들)
    <ul>
      <li>하드웨어 측면에서 보자면, TLB는 <strong>완전 연관</strong> 캐시이다.</li>
    </ul>
  </li>
  <li>TLB는 일반적으로 <strong>valid bit</strong>을 갖고 있다.
    <ul>
      <li>특정 항목이 유효한 변환 정보를 갖고 있는지 여부를 나타낸다.</li>
    </ul>
  </li>
  <li><strong>보호(protection)</strong>비트라는 것도 있다.
    <ul>
      <li>보호 비트들은 페이지가 어떻게 접근될 수 있는지를 나타낸다.</li>
    </ul>
  </li>
  <li><strong>더티 비트(dirty bit)</strong>라는 것도 있다.
    <ul>
      <li>페이지가 변경되었는지에 대한 정보를 가지고 있다.</li>
    </ul>
  </li>
</ul>

<h2 id="15-tlb의-문제-문맥-교환">1.5 TLB의 문제: 문맥 교환</h2>
<ul>
  <li>TLB에 있는 가상 주소와 실제 주소 간의 변환 정보는 그것을 탑재시킨 프로세스에서만 유효하다.
    <ul>
      <li>새로운 프로세스에서는 이전에 실행하던 프로세스의 변환 정보를 사용하지 않도록 주의해야 한다.</li>
    </ul>
  </li>
</ul>

<p><img src="../../assets/img/ostep/07/img_1.png" width="40%" height="100%" /></p>
<ul>
  <li>위의 그림은 TLB의 예이다.(문제가 있음)
    <ul>
      <li>하지만 위의 TLB에서는 VPN이 10이 두개가 있으며(process 1과 2의 가상 주소 10) 어떤 프로세스의 가상주소인지 확인할 수 없다.</li>
    </ul>
  </li>
  <li>
    <p>TLB가 정확하고 효율적으로 멀티 프로세스 간의 가상화를 지원하기 위해서는 추가적 기능이 필요하다.</p>
  </li>
  <li>한 방법은 문맥 교환을 수행할 때 다음 프로세스가 실행되기 전에 기존 TLB 내용을 비우는 것이다.
    <ul>
      <li>하지만 TLB 내용이 비어지면 문맥 교체가 빈번히 발생되면 TLB 미스가 많아진다.</li>
    </ul>
  </li>
  <li>다른 방법은 TLB 내에 <strong>주소 공간 식별자(address space identifier, ASID)</strong> 필드를 추가하는 것이다.
    <ul>
      <li>ASID는 <strong>프로세스 식별자(process identifier, PID)</strong>와 대략적으로 유사하다.</li>
    </ul>
  </li>
</ul>

<p><img src="../../assets/img/ostep/07/img_2.png" width="40%" height="100%" /></p>
<ul>
  <li>위의 그림은 ASID가 추가된 TLB의 모습이다.
    <ul>
      <li>ASID로 프로세스를 구분할 수 있게 됐다.</li>
    </ul>
  </li>
</ul>

<p><img src="../../assets/img/ostep/07/img_3.png" width="40%" height="100%" /></p>
<ul>
  <li>ASID를 사용하면 코드 페이지를 위의 그림처럼 공유하여 프로세스가 사용하는 물리 페이지의 수를 줄일 수 있다.</li>
</ul>

<h2 id="16-이슈-교체-정책">1.6 이슈: 교체 정책</h2>
<ul>
  <li>
    <p>모든 캐시가 그러하듯이 TLB에서도 <strong>캐시 교체(cache replacement)</strong> 정책이 매우 중요하다.</p>
  </li>
  <li>한 가지 흔한 방법은 가장 오래 전부터 사용되었던 <strong>최저 사용 빈도(least-recently-used, LRU)</strong> 항목을 교체하는 것이다.
    <ul>
      <li>LRU는 메모리 참조 패턴에서의 지역성을 최대한 활용하는 것이 목적이다.</li>
    </ul>
  </li>
  <li>다른 방법은 랜덤(random) 정책이다.
    <ul>
      <li>랜덤 정책에서는 교체 대상을 무작위로 정한다.</li>
      <li>랜덤 교체 정책은 구현이 간단하고 예상치 못한 예외 상황의 발생을 피할 수 있다는 장점이 있다.</li>
    </ul>
  </li>
</ul>

<h2 id="17-요약">1.7 요약</h2>
<ul>
  <li>지금까지 주소 변환을 더 빠르게 처리하기 위한 하드웨어 기법에 대해 살펴보았따.</li>
  <li>TLB를 주소 변환 캐시로 사용하여 대부분의 메모리 참조들은 메인 메모리 상의 페이지 테이블을 읽지 않고도 처리가 가능하게 되었따.</li>
  <li>프로그램이 짧은 시간 동안 접근하는 페이지들의 수가 TLB에 들어갈 수 잇는 수보다 많다면 TLB 미스를 발생할 것이고 느리게 동작하게 될 것이다.</li>
</ul>

<h1 id="2-페이징-더-작은-테이블">2. 페이징: 더 작은 테이블</h1>
<ul>
  <li>페이징의 두 번째 문제점은 페이지 테이블의 크기이다. 페이지 테이블이 크면 많은 메모리 공간을 차지한다.
    <ul>
      <li>단순한 배열 기반의 페이지 테이블은(흔히 선형 페이지 테이블이라고 불림) 크기가 크며 일반적인 시스템에서 메모리를 과도하게 차지한다.</li>
    </ul>
  </li>
</ul>

<h2 id="21-간단한-해법-더-큰-페이지">2.1 간단한 해법: 더 큰 페이지</h2>
<ul>
  <li>페이지 테이블의 크기를 간단하게 줄일 수 있는 방법이 한 가지 있다.
    <ul>
      <li>페이지 크기를 증가시키면 된다.</li>
    </ul>
  </li>
  <li>하지만 페이지 크기의 증가는 부작용을 수반한다.
    <ul>
      <li>가장 큰 문제는 페이지 내부의 낭비 공간이 증가하는 것이다.</li>
      <li>이를 <strong>내부 단편화</strong>라 한다(할당된 페이지 <strong>내부</strong>에서 낭비가 발생하기 때문이다).</li>
    </ul>
  </li>
</ul>

<h2 id="22-하이브리드-접근-방법-페이징과-세그멘트">2.2 하이브리드 접근 방법: 페이징과 세그멘트</h2>
<ul>
  <li>페이징과 세그멘테이션을 결합하여 페이지 테이블 크기를 줄이는 아이디어가 있다.</li>
  <li>결합 방식을 생각해 보자. 프로세스의 전체 주소 공간을 위해 하나의 페이지 테이블을 두는 대신, 논리 세그멘트마다 따로 페이지 테이블을 두면 어떨까?
    <ul>
      <li>코드, 힙 그리고 스택 세그멘트에 대해 페이지 테이블을 각각 두는 것이다.</li>
      <li>세그멘트와 비슷하게 <strong>베이스</strong> 레지스터와 <strong>바운드</strong> 또는 <strong>리미트</strong> 레지스터를 사용하여 페이지 테이블의 시작과 끝을 나타낸다.</li>
    </ul>
  </li>
</ul>

<p><img src="../../assets/img/ostep/07/img_4.png" width="90%" height="100%" /></p>
<ul>
  <li>위의 그림은 페이징과 세그먼트를 이용한 주소 공간이다.
    <ul>
      <li>상위 2비트를 소속 세그멘트를 나타내기 위해 사용한다.</li>
    </ul>
  </li>
  <li>하지만, 하이브리드 접근 방법 또한 문제가 있다.
    <ul>
      <li>여전히 세그멘테이션을 사용한다 ; 빈 공간이 많은 힙의 경우에는 테이블의 낭비를 면치 못할 수가 있다.</li>
      <li>하이브리드 기법은 외부 단편화를 유발한다.</li>
    </ul>
  </li>
</ul>

<h2 id="23-멀티-레벨-페이지-테이블">2.3 멀티 레벨 페이지 테이블</h2>
<ul>
  <li><strong>멀티 레벨 페이지 테이블</strong>에서는 선형 페이지 테이블을 트리 구조로 표현한다.</li>
  <li>멀티 레벨 페이지 테이블의 기본 개념은 간단하다.
    <ol>
      <li>먼저, 페이지 테이블을 페이지 크기의 단위로 나눈다.</li>
      <li>그다음, 페이지 테이블의 페이지가 유효하지 않은 항목만 있으면, 행당 페이지를 할당하지 않는다.</li>
    </ol>
  </li>
  <li><strong>페이지 디렉터리(page directory)</strong>라는 자료 구조를 사용하여 페이지 테이블 각 페이지의 할당 여부와 위치를 파악한다.
    <ul>
      <li>페이지 디렉터리는 페이지 테이블을 구성하는 각 페이지의 존재 여부와 위치 정보를 가지고 있다.</li>
    </ul>
  </li>
</ul>

<p><img src="../../assets/img/ostep/07/img_5.png" width="100%" height="100%" /></p>
<ul>
  <li>위의 그림은 선형 테이블과 멀티 레벨 페이지 테이블이다.</li>
  <li>간단한 2단계 테이블에서, 페이지 디렉터리의 각 항목은 페이지 테이블의 한 페이지를 나타낸다.
    <ul>
      <li>페이지 디렉터리는 <strong>페이지 디렉터리 항목(page directory entries, PDE)</strong>들로 구성된다.</li>
      <li><strong>유효(valid)</strong> 비트와 <strong>페이지 프레임 번호(page frame number, PFN)</strong>을 갖고 있다.</li>
    </ul>
  </li>
  <li>멀티 레벨 페이지 테이블의 장점
    <ul>
      <li>사용된 주소 공간의 크기에 비례하여 페이지 테이블 공간이 할당된다.
        <ul>
          <li>보다 작은 크기의 페이지 테이블로 주소 공간을 표현할 수 있다.</li>
        </ul>
      </li>
      <li>페이지 테이블을 페이지 크기로 분할함으로써 메모리 관리가 매우 용이하다.
        <ul>
          <li>페이지 테이블을 할당하거나 확장할 때, 운영체제는 free페이지 풀에 잇는 빈 페이지를 가져다 쓰면 된다.</li>
        </ul>
      </li>
      <li>페이지 테이블의 각 페이지들이 물리 메모리에 산재해 있더라도 페이지 디렉터리를 이용하여 그 위치를 파악할 수 있으므로 ,페이지 테이블을 위한 공간 할당이 매우 유연하다.</li>
    </ul>
  </li>
  <li>멀티 레벨 페이지 테이블의 유의 사항
    <ul>
      <li>TLB 미스 시, 주소 변환을 위해 두 번의 메모리 로드가 발생하여 추가 비용이 발생한다.</li>
      <li>복잡도</li>
    </ul>
  </li>
</ul>

<h2 id="24-역-페이지-테이블">2.4 역 페이지 테이블</h2>
<ul>
  <li>획기적인 공간 절약 방법으로 <strong>역 페이지 테이블(inverted page table)</strong>이 있다.</li>
  <li>시스템에 단 하나의 페이지 테이블만 둔다.</li>
  <li>페이지 테이블은 물리 페이지를 가상 주소 상의 페이지로 변환한다.</li>
</ul>

<h2 id="25-페이지-테이블을-디스크로-스와핑하기">2.5 페이지 테이블을 디스크로 스와핑하기</h2>
<ul>
  <li>어떤 시스템들은 페이지 테이블들을 <strong>커널 가상 메모리</strong>에 위치시키고, 메모리가 부족할 경우 페이지 테이블들을 디스크로 <strong>스왑(swap)</strong>한다.</li>
</ul>

<h2 id="26-요약">2.6 요약</h2>
<ul>
  <li>테이블을 위한 자료 구조에는 시간과 공간이라는 모순적 선택 사항이 존재한다.</li>
  <li>공간을 많이 소모하는 테이블 구조를 사용할 수록 TLB미스의 처리속도가 빨라진다.</li>
  <li>공간을 작게 차지한는 테이블 구조를 사용하면 상황은 반대가 된다.</li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 태그: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#cs" class="page__taxonomy-item p-category" rel="tag">CS</a><span class="sep">, </span>
    
      <a href="/tags/#ostep" class="page__taxonomy-item p-category" rel="tag">OSTEP</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 카테고리: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#ostep" class="page__taxonomy-item p-category" rel="tag">OSTEP</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time class="dt-published" datetime="2022-06-09T00:00:00+09:00">June 9, 2022</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">공유하기</h4>
  

  <a href="https://twitter.com/intent/tweet?text=%5BOSTEP%5D+%EB%A9%94%EB%AA%A8%EB%A6%AC+%EA%B0%80%EC%83%81%ED%99%94+-+%ED%8E%98%EC%9D%B4%EC%A7%95+%EA%B0%9C%EC%84%A0%28TLB%2C+%EB%8D%94+%EC%9E%91%EC%9D%80+%ED%85%8C%EC%9D%B4%EB%B8%94%29%20http%3A%2F%2Flocalhost%3A4000%2Fostep%2Fostep_07%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fostep%2Fostep_07%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fostep%2Fostep_07%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/%EB%B0%B1%EC%A4%80/python_49/" class="pagination--pager" title="[백준/Python] 16916 부분 문자열(문자열)
">이전</a>
    
    
      <a href="/ostep/ostep_08/" class="pagination--pager" title="[OSTEP] 메모리 가상화 - 물리 메모리 크기의 극복(메커니즘과 정책)
">다음</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">참고</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ostep/ostep_08/" rel="permalink">[OSTEP] 메모리 가상화 - 물리 메모리 크기의 극복(메커니즘과 정책)
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-06-09T00:00:00+09:00">June 9, 2022</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">OSTEP - 08
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/%EB%B0%B1%EC%A4%80/python_49/" rel="permalink">[백준/Python] 16916 부분 문자열(문자열)
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-05-28T00:00:00+09:00">May 28, 2022</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">백준 알고리즘 - 49
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/%EB%B0%B1%EC%A4%80/python_48/" rel="permalink">[백준/Python] 1316 그룹 단어 체커(문자열)
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-05-28T00:00:00+09:00">May 28, 2022</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">백준 알고리즘 - 48
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/%EB%B0%B1%EC%A4%80/python_47/" rel="permalink">[백준/Python] 14501 퇴사(DP)
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-05-27T00:00:00+09:00">May 27, 2022</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">백준 알고리즘 - 47
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="검색어를 입력하세요..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://github.com/hon99oo" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
          <li><a href="https://instagram.com/hon99oo" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 honggoo. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/ostep/ostep_07/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/ostep/ostep_07"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://honggoo.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
