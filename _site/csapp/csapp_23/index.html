<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>[CS:APP] Chapter 07 링커 - 홍구의 개발 블로그</title>
<meta name="description" content="CS:APP - 23">


  <meta name="author" content="honggoo">
  
  <meta property="article:author" content="honggoo">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="홍구의 개발 블로그">
<meta property="og:title" content="[CS:APP] Chapter 07 링커">
<meta property="og:url" content="http://localhost:4000/csapp/csapp_23/">


  <meta property="og:description" content="CS:APP - 23">



  <meta property="og:image" content="https://images.unsplash.com/photo-1501785888041-af3ef285b470?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80">





  <meta property="article:published_time" content="2022-05-03T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/csapp/csapp_23/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "honggoo",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="홍구의 개발 블로그 Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          홍구의 개발 블로그
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about_me/">About Me</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Category</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tag</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/">Archive</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero--overlay"
  style=" background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://images.unsplash.com/photo-1501785888041-af3ef285b470?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80');"
>
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        
          [CS:APP] Chapter 07 링커

        
      </h1>
      
        <p class="page__lead">CS:APP - 23
</p>
      
      

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-05-03T00:00:00+09:00">May 3, 2022</time>
      </span>
    

    

    
  </p>


      
      
    </div>
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/img/avatar2.png" alt="honggoo" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">honggoo</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>본격적인 개발 블로그를 시작해 볼까!</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Seoul, South Korea</span>
        </li>
      

      
        
          
            <li><a href="cocoti5797@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/hon99oo" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://instagram.com/hon99oo" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
  

  

  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="[CS:APP] Chapter 07 링커">
    <meta itemprop="description" content="CS:APP - 23">
    <meta itemprop="datePublished" content="2022-05-03T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      

      <section class="page__content e-content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-bars"></i> table of content</h4></header>
              <ul class="toc__menu"><li><a href="#chapter-07-링커">Chapter 07. 링커</a></li><li><a href="#71-컴파일러-드라이버">7.1 컴파일러 드라이버</a></li><li><a href="#72-정적연결">7.2 정적연결</a></li><li><a href="#73-목적파일">7.3 목적파일</a></li><li><a href="#74-재배치-가능-목적파일">7.4 재배치 가능 목적파일</a></li><li><a href="#75-심볼과-심볼-테이블">7.5 심볼과 심볼 테이블</a></li><li><a href="#76-심볼-해석">7.6 심볼 해석</a><ul><li><a href="#761-링커가-중복으로-정의된-전역-심볼을-해결하는-방법">7.6.1 링커가 중복으로 정의된 전역 심볼을 해결하는 방법</a></li><li><a href="#762-정적-라이브러리와-링크하기">7.6.2 정적 라이브러리와 링크하기</a></li><li><a href="#763-링커가-참조를-해석하기-위해-정적-라이브러리를-사용하는-방법">7.6.3 링커가 참조를 해석하기 위해 정적 라이브러리를 사용하는 방법</a></li></ul></li><li><a href="#77-재배치">7.7 재배치</a><ul><li><a href="#771-재배치-엔트리">7.7.1 재배치 엔트리</a></li><li><a href="#772-심볼-참조의-재배치">7.7.2 심볼 참조의 재배치</a></li></ul></li><li><a href="#78-실행-가능한-목적파일">7.8 실행 가능한 목적파일</a></li><li><a href="#79-실행-가능-목적파일의-로딩">7.9 실행 가능 목적파일의 로딩</a></li><li><a href="#710-공유-라이브러리로-동적-링크하기">7.10 공유 라이브러리로 동적 링크하기</a></li><li><a href="#711-applications-으로부터-공유-라이브러리를-로드하고-링크하기">7.11 Applications 으로부터 공유 라이브러리를 로드하고 링크하기</a></li><li><a href="#712-위치-독립성-코드pic">7.12 위치-독립성 코드(PIC)</a></li><li><a href="#713-라이브러리-삽입">7.13 라이브러리 삽입</a></li><li><a href="#714-요약">7.14 요약</a></li></ul>

            </nav>
          </aside>
        
        <h1 id="chapter-07-링커">Chapter 07. 링커</h1>
<ul>
  <li>링킹은 여러 개의 코드와 데이터를 모아서 연결하여 메모리에 로드될 수 있고 실행될 수 있는 한 개의 파이로 만드는 작업이다.
    <ul>
      <li>링킹은 컴파일 시에 수행할 수 있다.</li>
      <li>로더에 의해 로드 타임에, 응용프로그램에 의해 실행 시에도 수행될 수 있다.</li>
    </ul>
  </li>
  <li>링커는 소프트웨어 개발 시에 중요한 역할: 독립적인 컴파일을 가능하게 하기 때문이다.</li>
  <li>링커를 배우는 이유
    <ul>
      <li>큰 프로그램을 작성하는 데 도움이 된다.</li>
      <li>위험한 프로그래밍 에러를 피할 수 있다.</li>
      <li>어떻게 언어의 변수 영역 규칙이 구현되었는지 이해하는 데 도움이 된다.</li>
      <li>다른 중요한 시스템 개념을 이해할 수 있게 된다.</li>
      <li>공유 라이브러리에 대해 이해할 수 있다.</li>
    </ul>
  </li>
</ul>

<h1 id="71-컴파일러-드라이버">7.1 컴파일러 드라이버</h1>
<ul>
  <li>대부분의 컴파일 시스템은 사용자를 대신해서 언어 전처리기, 컴파일러, 어셈블러, 링커를 필요에 따라 호출하는 컴파일러 드라이버를 제공한다.</li>
  <li>컴파일 순서
    <ol>
      <li>C 전처리기(cpp)로 main.c -&gt; ASCII 중간 파일인 main.i로 번역</li>
      <li>C 컴파일러(cc1)로 main.i -&gt; ASCII 어셈블리 언어 파일인 main.s로 번역</li>
      <li>어셈블러(as)로 main.s -&gt; 재배치 가능한 바이너리 목적파일인 main.o로 번역</li>
      <li>링커(ld)로 main.o &amp; sum.o 두개를 연결 -&gt; 실행 가능 목적파일 prog 생성</li>
      <li>로더라고 부르는 운영체제 내의 함수를 호출 -&gt; 로더는 실행파일 prog의 코드와 데이터를 메모리로 복사하고, 제어를 프로그램의 시작 부분으로 전환한다.</li>
    </ol>
  </li>
</ul>

<p><img src="../../assets/img/csapp/23/img.png" width="50%" height="100%" /></p>

<h1 id="72-정적연결">7.2 정적연결</h1>
<ul>
  <li>정적 링커는 재배치 가능한 목적파일들과 명령줄 인자들을 받아들여 로드될 수 있고 실행될 수 있는 완전히 링크된 실행 가능 목적파일을 생성한다.</li>
  <li>실행파일을 만들기 위해서 링커는 두 가지 주요 작업을 수행한다.
    <ol>
      <li>심볼 해석 symbol resolutions: 각각의 심볼 참조를 정확하게 하나의 심볼 정의에 연결하는 것이다.</li>
      <li>재배치 Relocation: 링커는 섹션들을 각 심볼 정의와 연결시켜 재배치한다.</li>
    </ol>
  </li>
</ul>

<h1 id="73-목적파일">7.3 목적파일</h1>
<ul>
  <li>세가지 목적파일이 있다.
    <ul>
      <li>재배치 가능 목적파일 Relocatable object file: 다른 재구성가능 목적파일들과 결합될 수 있는 바이너리 코드와 데이터를 포함</li>
      <li>실행 가능 목적파일 Executable object file: 메모리에 직접 복사될 수 있고 실행될 수 있음</li>
      <li>공유 목적파일 Shared object file: 로드타임 또는 런타임 시에 동적으로 링크되고 로드될 수 있는 목적파일</li>
    </ul>
  </li>
  <li>컴파일러와 어셈블러는 재배치 가능 목적파일을 생성, 링커는 실행 가능한 목적파일을 생성</li>
</ul>

<h1 id="74-재배치-가능-목적파일">7.4 재배치 가능 목적파일</h1>

<p><img src="../../assets/img/csapp/23/img_1.png" width="50%" height="100%" /></p>
<ul>
  <li>위의 그림은 전형적인 ELF(Executable and Linkable Format) 재배치 가능 목적파일의 포맷이다.
    <ul>
      <li>.text: 컴파일된 프로그램의 머신 코드</li>
      <li>.rodata: printf 문장의 포맷 스트링</li>
      <li>.data: 초기화된 전역변수 및 정적변수</li>
      <li>.bss: 초기화되지 않은 또는 0으로 초기화된 전역변수 및 정적변수</li>
      <li>.symtab: 프로그램에서 정의되고 참조되는 전역변수들과 함수에 대한 정보를 가지고 있는 심볼 테이블</li>
      <li>.rel.text: 다른 목적 파일들과 연결할 때 링커가 수정해야하는 .text 섹션 내 위치들의 리스트</li>
      <li>.rel.data: 전역변수들에 대한 재배치 정보</li>
      <li>.debug: 프로그램 내에서 정의된 지역변수들과 typedef</li>
      <li>.line: 최초 소스 프로그램과 .text 섹션 내 머신 코드 인스트럭션 내 라인 번호들간의 매핑</li>
      <li>.strtab: 섹션 이름들을 위한 스트링 테이블</li>
    </ul>
  </li>
</ul>

<h1 id="75-심볼과-심볼-테이블">7.5 심볼과 심볼 테이블</h1>
<ul>
  <li>재배치 가능 목적 모듈 m은 m에 의해서 정의되고 참조되는 심볼들에 대한 정보를 포함하는 심볼 테이블을 가지고 있다.
    <ul>
      <li>m에 의해 정의되고 다른 모든 모듈들에 의해서 참조될 수 있는 전역 심볼
        <ul>
          <li>전역</li>
        </ul>
      </li>
      <li>m에 의해 참조되지만 다른 모듈에 의해 정의된 전역 심볼
        <ul>
          <li>external</li>
        </ul>
      </li>
      <li>m에 의해서 배타적으로 참조되고 정의된 지역 심볼
        <ul>
          <li>static</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>지역 변수는 런타임에 스택에 의해서 관리되며 링커에는 관심거리가 아니다.</p>
</blockquote>

<ul>
  <li>
    <p>.symtab 섹션의 ELF 심볼 테이블은 엔트리들의 배열을 포함하고 있다.
<img src="../../assets/img/csapp/23/img_2.png" width="70%" height="100%" /></p>
  </li>
  <li>
    <p>테이블 엔트리가 없는 의사 섹션pseudo section 이 존재한다.</p>
    <ul>
      <li>ABS: 재배치해서는 안 되는 심볼</li>
      <li>UNDEF: 정의되지 않은 심볼, 해당 모듈에서는 참조만 되고 다른 곳에서 정의된 심볼들을 위함</li>
      <li>COMMON: 아직 할당되거나 초기화되지 않은 데이터 객체를 위함</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>COMMON: 초기화하지 않은 전역변수들, .bss: 초기화하지 않은 정적변수들과 0으로 초기화된 전역변수나 정적변수들</p>
</blockquote>

<h1 id="76-심볼-해석">7.6 심볼 해석</h1>
<ul>
  <li>링커는 자신의 입력 재배치 가능 목적파일들의 심볼 테이블로부터 정확히 한 개의 심볼 정의에 각 참조를 연결시켜서 심볼 참조를 해석한다.</li>
  <li>컴파일러가 현재 모듈에서 정의되지 않은 심볼을 만나면, 다른 모듈에서 정의되어 있다고 가정하고 링커 심볼 테이블 엔트리를 생성하며, 링커가 이것을 처리하도록 남겨둔다.</li>
</ul>

<h2 id="761-링커가-중복으로-정의된-전역-심볼을-해결하는-방법">7.6.1 링커가 중복으로 정의된 전역 심볼을 해결하는 방법</h2>
<ul>
  <li>링커의 입력은 여러 개의 재배치 가능한 오브젝트 모듈들이다.
    <ul>
      <li>일부는 지역적이다(정의된 모듈 내에서만 볼 수 있는).</li>
      <li>일부는 전역적이다(다른 모듈에서도 볼 수 있는).</li>
    </ul>
  </li>
  <li>컴파일러는 각 전역 심볼을 어셈블러로 강하게 또는 약하게 보내 심볼 테이블에 묵시적으로 인코딩하게 한다.
    <ul>
      <li>함수들과 초기화된 전역변수들은 강한 심볼</li>
      <li>비초기화된 전역변수들은 약한 심볼이다.</li>
    </ul>
  </li>
  <li>링커는 중복된 심볼 이름을 처리하기 위해서 다음과 같은 규칙을 사용한다.
    <ol>
      <li>동일한 이름을 갖는 복수의 강한 심불은 허용 X</li>
      <li>동일한 이름의 강한 심볼과 다수의 약한 심볼들이 있으면 강한 심볼 선택</li>
      <li>동일한 이름의 여러 개의 약한 심볼이 있으면 어떤 약한 심볼을 선택해도 관계 X</li>
    </ol>
  </li>
</ul>

<h2 id="762-정적-라이브러리와-링크하기">7.6.2 정적 라이브러리와 링크하기</h2>
<ul>
  <li>모든 컴파일 시스템은 관련된 객체 모듈들을 <code class="language-plaintext highlighter-rouge">정적 라이브러리</code>라고 부르는 한 개의 파일로 패키징하는 매커니즘을 제공한다.
    <ul>
      <li>이 라이브러리는 다음에 링커의 입력으로 제공될 수 있다.</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>컴파일러 개발자들이 라이브러리의 다양한 함수들을 정적 라이브러리의 혜택 없이 사용자들에게 재공하려면 컴파일러가 직접 함수의 코드를 생성하거나 한 개의 재배치 가능 목적 모듈에
저장하거나 해야한다. 하지만 이런 방법들은 상당한 복잡성을 더하거나 디스크 공간을 극도로 낭비한다. 위와 같은 접근 방법의 단점들을 해겨하기 위해 정적 라이브러리 개념이 개발되었다.</p>
</blockquote>

<p><img src="../../assets/img/csapp/23/img_3.png" width="70%" height="100%" /></p>
<ul>
  <li>위 그림은 정적 라이브러리 연결 시 링커의 동작을 요약한 것이다.</li>
</ul>

<h2 id="763-링커가-참조를-해석하기-위해-정적-라이브러리를-사용하는-방법">7.6.3 링커가 참조를 해석하기 위해 정적 라이브러리를 사용하는 방법</h2>
<ul>
  <li>링커는 실행파일을 구성하기 위해 합쳐질 재배치 가능 목적파일들의 집합 E, 미해석 집합 U, 이전 입력파일에서 정의된 심볼 집합 D를 유지한다.
    <ol>
      <li>입력파일 f에 대해서 링커는 f가 목적파일 또는 아카이브인지 결정한다.</li>
      <li>f가 목적파일이면 f를 E에 추가하고 U와 D를 갱신한다.</li>
      <li>f가 아카이브라면, 링커는 U 안의 미해석 심볼들을 아카이브의 멤버들에 의해 정의된 심볼들과 매칭하려고 시도한다.</li>
      <li>심볼을 정의한다면 m은 E에 추가되고 U와 D를 갱신한다.</li>
      <li>위 과정을 U와 D가 더 이상 바뀌지 않는 일정 지점까지 반복 실행한다.</li>
      <li>스캔을 끝마칠 때 U가 비어있지 않다면 에러 출력, 그렇지 않다면 E에 있는 목적파일들을 합치고 재배치해서 출력 실행파일을 만든다.</li>
    </ol>
  </li>
</ul>

<blockquote>
  <p>위의 알고리즘은 명령줄의 라이브러리와 목적파일의 순서가 중요한 이유가 된다.</p>
</blockquote>

<h1 id="77-재배치">7.7 재배치</h1>
<ul>
  <li>링커가 심볼 해석 단계를 완료하면, 코드 내 각 심볼 참조는 정확히 한 개의 심볼 정의에 연결된다.(입력 모듈 중 하나의 심볼 테이블 엔트리로 연결됨)</li>
  <li>이후 재배치를 하게 된다. 재배치는 두 단계로 구성된다.
    <ol>
      <li>섹션과 심볼 정의를 재배치한다.</li>
      <li>섹션 내 심볼 참조를 재배치한다.</li>
    </ol>
  </li>
</ul>

<h2 id="771-재배치-엔트리">7.7.1 재배치 엔트리</h2>
<ul>
  <li>어셈블러가 목적 모듈을 생성할 때, 어셈블러는 코드와 데이터가 궁극적으로 메모리 어디에 저장될지 알지 못한다.
    <ul>
      <li>어셈블러가 위치를 알지 못하는 객체로의 참조를 만나면, 링커에게 이 참조를 어떻게 수정하는지 알려주는 재배치 엔트리를 생성한다.</li>
    </ul>
  </li>
</ul>

<p><img src="../../assets/img/csapp/23/img_4.png" width="70%" height="100%" /></p>

<ul>
  <li>재배치 타입
    <ul>
      <li>R_X86_64_PC32: 32비트 PC-상대주소를 사용하는 참조를 재배치한다.</li>
      <li>R_X86_64_32: 32비트 절대주소를 사용하는 참조를 재배치한다.</li>
    </ul>
  </li>
</ul>

<h2 id="772-심볼-참조의-재배치">7.7.2 심볼 참조의 재배치</h2>

<p><img src="../../assets/img/csapp/23/img_5.png" width="70%" height="100%" /></p>
<ul>
  <li>위의 그림은 링커의 재배치 알고리즘을 위한 의사코드이다.</li>
</ul>

<h1 id="78-실행-가능한-목적파일">7.8 실행 가능한 목적파일</h1>

<p><img src="../../assets/img/csapp/23/img_6.png" width="70%" height="100%" /></p>

<ul>
  <li>실행 가능 목적파일의 포맷은 재배치 가능한 목적파일의 포맷과 유사하다.
    <ul>
      <li>.text, .rodata, .data 섹션들이 각자의 최종 런타임 메모리 주소로 재배치되었다.</li>
      <li>_init는 프로그램의 초기화 코드에서 호출한다.</li>
      <li>실행파일이 완전히 링크(재배치) 되었기 때문에, .rel 섹션을 필요로 하지 않는다.</li>
    </ul>
  </li>
  <li>ELF 실행파일들은 연속적인 메모리 세그멘트에 매핑된 연속적인 실행 가능 파일들의 덩어리로 메모리에 로드하기 쉽도록 설계되었다.
    <ul>
      <li>이 매핑은 프로그램 헤더 테이블에 설명되어 있다.</li>
    </ul>
  </li>
  <li>모든 세그먼트 s에 대해, 링커는 다음과 같이 시작주소를 선택해야 한다.
    <ul>
      <li>vaddr mod align = off mod align</li>
      <li>align은 프로그램 헤더에 명시된 정렬(2^21 = 0x2000000)이다.</li>
      <li>이러한 정렬 요구사항은 프로그램이 실행될 때 목적파일의 세그먼트들이 메모리로 효과적으로 전송될 수 있도록 하는 최적화의 결과다.
        <ul>
          <li>가상메모리가 크기가 큰 연속된 2의 제곱 크기의 바이트 묶음으로 구성되어 있는 방식이기 때문이다.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h1 id="79-실행-가능-목적파일의-로딩">7.9 실행 가능 목적파일의 로딩</h1>
<ol>
  <li>실행 가능 목적파일 prog를 실행한다.</li>
  <li>쉘은 로더loader 라고 알려진 메모리 상주 운영체제 코드를 호출해서 prog를 실행한다.</li>
  <li>로더는 디스크로부터 실행 가능한 목적파일 내의 코드와 데이터를 메모리로 복사한다.</li>
  <li>해당 프로그램의 첫 번째 인스트럭션, 즉 엔트리 포인트로 점프해서 프로그램을 실행한다.</li>
</ol>

<p><img src="../../assets/img/csapp/23/img_7.png" width="70%" height="100%" /></p>
<ul>
  <li>모든 실행 중인 리눅스 프로그램은 위의 그림과 유사한 런타임 메모리 이미지를 가진다.</li>
</ul>

<h1 id="710-공유-라이브러리로-동적-링크하기">7.10 공유 라이브러리로 동적 링크하기</h1>
<ul>
  <li>정적 라이브러리들은 다른 모든 소프트웨어처럼 관리해야 하고 주기적으로 갱신해야한다.</li>
  <li>공유 라이브러리들은 정적 라이브러리의 단점들을 극복한다.
    <ul>
      <li>공유 라이브러리는 런타임이나 로드타임에 임의의 메모리 주소에서 로드되고, 메모리에서 프로그램으로 연결될 수 있는 목적 모듈이다.</li>
      <li>해당 과정을 동적 링킹이라고 한다.</li>
      <li>리눅스 시스템에서 .so 확장자, 윈도우 시스템에서 DLL(dynamic link libraries)이라고 부른다.</li>
    </ul>
  </li>
  <li>공유 라이브러리들은 두 가지 다른 방법으로 “공유”된다.
    <ol>
      <li>어떤 주어진 파일 시스템에서, 특정 라이브러리에 대해 정확히 한 개의 .so 파일만이 존재한다.
        <ul>
          <li>.so 파일 내의 코드와 데이터는 이 라이브러리를 참조하는 모든 실행 가능한 목적파일들에 의해 공유된다.</li>
        </ul>
      </li>
      <li>메모리에 있는 공유 라이브러리의 .text 섹션은 서로 다른 실행중의 프로세스들에 의해 공유될 수 있다.</li>
    </ol>
  </li>
</ul>

<p><img src="../../assets/img/csapp/23/img_8.png" width="70%" height="100%" /></p>
<ul>
  <li>위의 그림은 공유 라이브러리로 동적 링크 과정을 요약한 것이다.</li>
  <li>기본 아이디어는 링킹의 일부는 실행 가능 파일이 생성될 때 정적으로 수행하고, 프로그램이 로드될 때 링킹 작업을 동적으로 완료하는 것이다.</li>
</ul>

<h1 id="711-applications-으로부터-공유-라이브러리를-로드하고-링크하기">7.11 Applications 으로부터 공유 라이브러리를 로드하고 링크하기</h1>
<ul>
  <li>응용프로그램이 돌고 있는 동안에 동적 링커에게 응용프로그램을 컴파일 시에 라이브러리와 링크할 필요 없이 임의의 공유 라이브러리를 로드하고 링크할 것을 요청할 수도 있다.</li>
  <li>기본 아이디어는 공유 라이브러리에서 동적 콘텐츠를 생성하는 각 함수들을 패키지 하는 것이다.
    <ul>
      <li>서버는 동적으로 적당한 함수를 로드하고 링크한 뒤에 직접 호출한다.</li>
      <li>함수는 서버의 주소공간에 캐시된 상태로 남으며, 후속 요청들은 간단한 함수 호출하는 비용만으로 처리될 수 있다.</li>
    </ul>
  </li>
</ul>

<h1 id="712-위치-독립성-코드pic">7.12 위치-독립성 코드(PIC)</h1>
<ul>
  <li>공유 라이브러리를 사용하는 주목적은 다수의 실행되고 있는 프로세스들이 메모리 내에서 동일한 라이브러리 코드를 공유하도록 하는 것이며, 귀중한 메모리 자원을 절약하는 것이다.
    <ul>
      <li>한 가지 접근 방법은 공유 라이브러리를 사전에 정해진 주소공간 블록에 할당 하는 것이다.
        <ul>
          <li>단점 : 사용하지 않을 때도 할당, 메모리 블록들이 중첩되지 않도록 보장해줘야 함</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>위의 문제점을 피하기 위해 공유 모듈들의 코드 일부분을 컴파일해서 링커에 의해 수정되지 않고도 이들이 메모리 어디든지 로드될 수 있도록 한다.
    <ul>
      <li>어떠한 재배치 작업 없이 로드될 수 있는 코드는 위치-독립성코드라고 한다.(PIC)</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>PIC와 GOT, PLT는 아직 이해를 하지 못해 좀 더 찾아보고 공부해야 한다.</p>
</blockquote>

<h1 id="713-라이브러리-삽입">7.13 라이브러리 삽입</h1>
<ul>
  <li>컴파일 삽입</li>
  <li>링크 삽입</li>
  <li>런타임 삽입</li>
</ul>

<h1 id="714-요약">7.14 요약</h1>
<ul>
  <li>링킹은 컴파일 시에 정적 링커에 의해 수행될 수 있으며, 로드타임과 런타임에는 동적 링커에 의해 수행된다.</li>
  <li>목적 파일들은 세 가지 형태로 나타난다.
    <ul>
      <li>재배치 가능: 정적 링커에 의해 실행 가능 목적파일로 연결</li>
      <li>실행 가능: 메모리에 로드되고 실행</li>
      <li>공유: 공유 라이브러리</li>
    </ul>
  </li>
  <li>링커의 두 가지 주요 임무
    <ul>
      <li>전역 심볼들이 유일한 정의에 연결되는 경우 심볼 해석</li>
      <li>재배치 작업</li>
    </ul>
  </li>
  <li>로더는 실행파일의 내용을 메모리로 매핑하고 프로그램을 실행한다.</li>
</ul>


        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 태그: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#cs" class="page__taxonomy-item p-category" rel="tag">CS</a><span class="sep">, </span>
    
      <a href="/tags/#cs-app" class="page__taxonomy-item p-category" rel="tag">CS:APP</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 카테고리: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#csapp" class="page__taxonomy-item p-category" rel="tag">CSAPP</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time class="dt-published" datetime="2022-05-03T00:00:00+09:00">May 3, 2022</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">공유하기</h4>
  

  <a href="https://twitter.com/intent/tweet?text=%5BCS%3AAPP%5D+Chapter+07+%EB%A7%81%EC%BB%A4%20http%3A%2F%2Flocalhost%3A4000%2Fcsapp%2Fcsapp_23%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fcsapp%2Fcsapp_23%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fcsapp%2Fcsapp_23%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/dataengineering/de_02/" class="pagination--pager" title="[DataEngineering] 첫 번째 데이터엔지니어 인턴 회고
">이전</a>
    
    
      <a href="/csapp/csapp_24/" class="pagination--pager" title="[CS:APP] Chapter 08 예외적인 제어흐름
">다음</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">참고</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/%EB%B0%B1%EC%A4%80/python_14/" rel="permalink">[백준/Python] 1206 DFS와 BFS(DFS/BFS)
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-05-16T00:00:00+09:00">May 16, 2022</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">백준 알고리즘 - 14
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/%EB%B0%B1%EC%A4%80/python_13/" rel="permalink">[백준/Python] 2606 바이러스(DFS/BFS)
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-05-16T00:00:00+09:00">May 16, 2022</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">백준 알고리즘 - 13
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/%EB%B0%B1%EC%A4%80/python_12/" rel="permalink">[백준/Python] 10044 Project Teams(그리디)
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-05-15T00:00:00+09:00">May 15, 2022</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">백준 알고리즘 - 12
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/%EB%B0%B1%EC%A4%80/python_11/" rel="permalink">[백준/Python] 17609 회문(그리디)
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-05-15T00:00:00+09:00">May 15, 2022</time>
      </span>
    

    

    
  </p>


    <p class="archive__item-excerpt" itemprop="description">백준 알고리즘 - 11
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="검색어를 입력하세요..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://github.com/hon99oo" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
          <li><a href="https://instagram.com/hon99oo" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 honggoo. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/csapp/csapp_23/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/csapp/csapp_23"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://honggoo.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
